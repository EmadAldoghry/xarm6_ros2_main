import os
import yaml


class __XArmDynamics(object):
    CONFIG_NAME = None
    MASS = []
    ORIGIN = []
    INERTIA = []
    
    @classmethod
    def gen(cls):
        data = {}
        for i in range(len(cls.MASS)):
            data['link{}'.format((i + 1))] = {
                'mass': cls.MASS[i],
                'origin': {
                    'x': cls.ORIGIN[i][0],
                    'y': cls.ORIGIN[i][1],
                    'z': cls.ORIGIN[i][2]
                },
                'inertia': {
                    'ixx': cls.INERTIA[i][0],
                    'ixy': -cls.INERTIA[i][1],
                    'ixz': -cls.INERTIA[i][2],
                    'iyy': cls.INERTIA[i][3],
                    'iyz': -cls.INERTIA[i][4],
                    'izz': cls.INERTIA[i][5],
                },
            }
        try:
            filepath = os.path.join(os.path.dirname(__file__), cls.CONFIG_NAME)
            with open(filepath, 'w', encoding='utf-8') as f:
                yaml.dump(data, f, default_flow_style=False, allow_unicode=True)
            print('write {} success'.format(cls.CONFIG_NAME))
        except Exception as e:
            print('write {} exception, {}'.format(cls.CONFIG_NAME, e))


class XArm6x4Dynamics_HT_BR(__XArmDynamics):
    CONFIG_NAME = 'xarm6_type6_HT_BR.yaml'
    MASS = [2.177, 2.011, 1.725, 1.211, 1.206, 0.17]
    ORIGIN = [
        [0.00015, 0.02724, -0.01357], 
        [0.0367, -0.22088, 0.03356], 
        [0.06977, 0.1135, 0.01163], 
        [-0.0002, 0.02, -0.026], 
        [0.06387, 0.02928, 0.0035], 
        [0, -0.00677, -0.01098]
    ]
    INERTIA = [
        [0.005433, -9.864E-06, 2.68E-05, 0.004684, 0.000826936, 0.0031118],
        [0.0271342, -0.004736, -0.00068673, 0.0053854, 0.0047834, 0.0262093],
        [0.006085, 0.001500, -0.0009558, 0.0036652, -0.0018091, 0.0057045],
        [0.0046981, 6.486E-06, 1.404E-05, 0.0042541, 0.0002877, 0.00123664],
        [0.0013483, 0.00042677, -0.00028758, 0.00175694, -1.244E-04, 0.002207],
        [9.3E-05, 0.0, 0.0, 5.87E-05, 3.6E-06, 1.32E-04]
    ]

class XArm6x4Dynamics_HT_BR2(__XArmDynamics):
    CONFIG_NAME = 'xarm6_type6_HT_BR2.yaml'
    MASS = [2.3814, 2.2675, 1.875, 1.3192, 1.33854, 0.17]
    ORIGIN = [
        [0.00022, 0.02951, -0.0124], 
        [0.03881, -0.22783, 0.03496], 
        [0.07041, 0.11631, 0.0107], 
        [-0.00018, 0.01798, -0.02291], 
        [0.0651, 0.03096, 0.00315], 
        [0, -0.00677, -0.01098]
    ]
    INERTIA = [
        [0.0058562, 1.79E-05, -3.55E-06, 0.0050316, 0.000888336, 0.003536652],
        [0.028315776, -0.005, -0.00066546, 0.0058, 0.0045741, 0.0273447],
        [0.0063483, 0.0015397, -0.00096858, 0.00379758, -0.00186567, 0.00595768],
        [0.004896, 6.925E-06, 1.418E-05, 0.00445694, 0.00023186, 0.00134332],
        [0.00146378, 0.000450624, -0.000284306, 0.00184192, -1.30866E-04, 0.002333524],
        [9.3E-05, 0.0, 0.0, 5.87E-05, 3.6E-06, 1.32E-04]
    ]

class XArm6x4Dynamics_HT_LD(__XArmDynamics):
    CONFIG_NAME = 'xarm6_type6_HT_LD.yaml'
    MASS = [2.459, 2.211, 1.925, 1.36, 1.354, 0.17]
    ORIGIN = [
        [0.00013, 0.0301, -0.012], 
        [0.0382, -0.2266, 0.0347], 
        [0.0706, 0.11715, 0.0104], 
        [0.00018, 0.0177, -0.023], 
        [0.0652, 0.03179, 0.00311], 
        [0, -0.00677, -0.01098]
    ]
    INERTIA = [
        [0.005795, -1.078E-05, -2.63E-05, 0.004969, 0.000911, 0.003428],
        [0.027996, -0.0049288, -0.0006482, 0.005557, 0.0046353, 0.02713],
        [0.0064294, 0.00155127, -0.0009724, 0.00384075, -0.00188257, 0.00603585],
        [0.004887, 6.996E-05, 1.334E-05, 0.0044147, 0.0002229, 0.0013373],
        [0.001473, 0.00046355, -0.00029315, 0.00185, -1.35E-04, 0.0023493],
        [9.3E-05, 0.0, 0.0, 5.87E-05, 3.6E-06, 1.32E-04]
    ]

class XArm6x4Dynamics_HT2_LD(__XArmDynamics):
    CONFIG_NAME = 'xarm6_type6_HT2_LD.yaml'
    MASS = [2.459, 2.663, 2.27, 1.36, 1.354, 0.2136]
    ORIGIN = [
        [0.00013, 0.0301, -0.012], 
        [0.04096, -0.2363, 0.03154], 
        [0.0717, 0.1159, 0.00884], 
        [0.00018, 0.0177, -0.023], 
        [0.0652, 0.03179, 0.00311], 
        [0, -0.00704, -0.00993]
    ]
    INERTIA = [
        [0.005795, -1.078E-05, -2.63E-05, 0.004969, 0.000911, 0.003428],
        [0.02992763, -0.00528326, -0.000777505, 0.0063873, 0.00501448, 0.02868],
        [0.00672878, 0.00153395, -0.000989667, 0.0040289, -0.001857759, 0.00632038],
        [0.004887, 6.996E-05, 1.334E-05, 0.0044147, 0.0002229, 0.0013373],
        [0.001473, 0.00046355, -0.00029315, 0.00185, -1.35E-04, 0.0023493],
        [9.3E-05, 0.0, 0.0, 5.87E-05, 3.6E-06, 1.32E-04]
    ]

class XArm6x5Dynamics_HT2_BR2(__XArmDynamics):
    """
    1M reach version, new Benrun, new HT motor at J3
    """
    CONFIG_NAME = 'xarm6_type8_HT2_BR2.yaml'
    MASS = [2.3814, 3.6325, 1.7269, 2.04, 1.325, 0.17]
    ORIGIN = [
        [0.00022, 0.02951, -0.0124], 
        [0.02539, -0.3017, -0.0032], 
        [0.07047, -0.11575, 0.012], 
        [-0.00022, 0.01039, -0.099],
        [0.0651, 0.03096, 0.00315], 
        [0, -0.00677, -0.01098]
    ]
    INERTIA = [
        [0.0058562, 1.79E-05, -3.55E-06, 0.0050316, 0.000888336, 0.003536652],
        [0.071521173, -0.010673573, -0.0020764, 0.009574546, 0.01384463, 0.069974876],
        [0.005889, -0.00137112, -0.00088143, 0.00359703, 0.001762155, 0.00543244],
        [0.004896, 6.925E-06, 1.418E-05, 0.00445694, 0.00023186, 0.00134332],
        [0.00146378, 0.000450624, -0.000284306, 0.00184192, -1.30866E-04, 0.002333524],
        [9.3E-05, 0.0, 0.0, 5.87E-05, 3.6E-06, 1.32E-04]
    ]


class XArm6x8Dynamics_HT_LD(__XArmDynamics):
    """
    800mm xarm6
    """
    CONFIG_NAME = 'xarm6_type11_HT_LD.yaml'
    MASS = [2.280, 2.545, 1.836, 1.41, 1.354, 0.17]
    ORIGIN = [
        [-0.00033, 0.02745, -0.014], 
        [0.04025, -0.3603, 0.0102], 
        [0.06865, -0.1133, 0.0132], 
        [0.00033, 0.0148, -0.0307], 
        [0.0652, 0.03179, 0.00311], 
        [0, -0.00677, -0.01098]
    ]
    INERTIA = [
        [0.005768, 1.6654E-05, -2.528E-06, 0.005052, 0.0008984, 0.003212],
        [0.076034, -8.6817E-03, -3.44615E-03, 0.0131983, 0.01936147, 0.068486],
        [0.0068547, -1.8093E-03, -0.001098, 4.08725E-03, 0.00212676, 0.0064999],
        [0.004887, 6.996E-05, 1.334E-05, 0.0044147, 0.0002229, 0.0013373],
        [0.001473, 0.00046355, -0.00029315, 0.00185, -1.35E-04, 0.0023493],
        [9.3E-05, 0.0, 0.0, 5.87E-05, 3.6E-06, 1.32E-04]
    ]

class XArm6x6Dynamics_HT_BR2(__XArmDynamics):
    """
    Lite6
    """
    CONFIG_NAME = 'xarm6_type9_HT_BR2.yaml'
    MASS = [1.411, 1.34, 0.953, 1.284, 0.804, 0.130]
    ORIGIN = [
        [-0.00036, 0.04195, -0.0025],
        [0.179, 0.0, 0.0584],
        [0.072, -0.0357, -0.001],
        [-0.002, -0.0285, -0.0813],
        [0.0, 0.010, 0.0019],
        [0.0, -0.00194, -0.0102]
    ]
    INERTIA = [
        [1451.64*1E-06, 12.4*1E-06, -6.7*1E-06, 887.3*1E-06, 125.5*1E-06, 1319.93*1E-06],
        [1585.4*1E-06, -6.766*1E-06, -1151.36*1E-06, 5609.7*1E-06, 1.14*1E-06, 4850*1E-06],
        [886.1*1E-06, -392.87*1E-06, 70.66*1E-06, 1578.5*1E-06, -24.45*1E-06, 1846.77*1E-06],
        [3705*1E-06, -2.0*1E-06, 7.17*1E-06, 3045.5*1E-06, -931.88*1E-06, 1541.3*1E-06],
        [566.8*1E-06, 0.6*1E-06, -5.3*1E-06, 507.7*1E-06, -0.48*1E-06, 530*1E-06],
        [77.26*1E-06, 1E-06, 0.4*1E-06, 85.665*1E-06, -0.6*1E-06, 148.14*1E-06]
    ]

class XArm6x12Dynamics_HT_LDBR2(__XArmDynamics):
    """
    ufacoty 850
    """
    CONFIG_NAME = 'xarm6_type12_HT_LDBR2.yaml'
    MASS = [4.807, 3.28, 2.237, 2.041, 1.385, 0.225]
    ORIGIN = [
        [5.7E-5, 0.013842, -0.02055],
        [0.323425, 9.5E-5, 0.007586],
        [0.128834, 0.11341, 0.00978],
        [2.66E-4, -0.03833, -0.101915],
        [5.7E-5, -0.015267, -0.001015],
        [4.84E-4, -3.34E-4, -0.014217]
    ]
    INERTIA = [
        [22001.729*1E-06, 11.152*1E-06, -6.738*1E-06, 18900.685*1E-06, 364.084*1E-06, 12270.188*1E-06],
        [7611.984*1E-06, 33.561*1E-06, -8240.021*1E-06, 64208.54*1E-06, 16.145*1E-06, 61175.7*1E-06],
        [9920.314*1E-06, 5137.841*1E-06, -2628.426*1E-06, 8923.236*1E-06, -2412.869*1E-06, 14284.81*1E-06],
        [19918.597*1E-06, 23.185*1E-06, -58.169*1E-06, 17515.194*1E-06, -5878.608*1E-06, 4283.807*1E-06],
        [2077.454*1E-06, 5.026*1E-06, 0.699*1E-06, 1109.183*1E-06, -6.747*1E-06, 2035.7*1E-06],
        [130.252*1E-06, 4.285*1E-06, -0.319*1E-06, 128.308*1E-06, 0.386*1E-06, 232.5*1E-06]
    ]

class XArm6x4Dynamics_UJ_BR_2403(__XArmDynamics):
    CONFIG_NAME = 'xarm6_type6_UJ_BR_2403.yaml'
    MASS = [2.531, 2.242, 2.019, 1.361, 1.345, 0.173]
    ORIGIN = [
        [-0.00017, 0.03575, -0.00647],
        [0.04084, -0.2403, 0.0324],
        [0.0714, 0.1268, 0.0109],
        [0.000185, 0.01466, -0.02197],
        [0.0682, 0.03342, 0.00263],
        [0.00084, -0.00359, -0.01326]
    ]
    INERTIA = [
        [0.005645, 2.2E-05, 0.0, 0.0038, 0.000597, 0.004567],
        [0.023006, -0.00408, -0.000515, 0.005974, 0.003713, 0.02183],
        [0.007602, 0.001578, -0.000916, 0.004263, -0.0021, 0.00708],
        [0.004888, 1.2E-05, 4E-06, 0.004184, -7E-06, 0.001731],
        [0.001622, 0.000335, -0.000246, 0.00171, -1.14E-04, 0.002286],
        [0.000112, 0.0, 0.0, 9E-05, 3.0E-06, 1.8E-04]
    ]

if __name__ == '__main__':

    XArm6x4Dynamics_HT_BR.gen()
    XArm6x4Dynamics_HT_BR2.gen()
    XArm6x4Dynamics_HT_LD.gen()
    XArm6x4Dynamics_HT2_LD.gen()
    
    XArm6x5Dynamics_HT2_BR2.gen()
    
    XArm6x8Dynamics_HT_LD.gen()
    
    XArm6x6Dynamics_HT_BR2.gen()

    XArm6x12Dynamics_HT_LDBR2.gen()
    
    XArm6x4Dynamics_UJ_BR_2403.gen()

